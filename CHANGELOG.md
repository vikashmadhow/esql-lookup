# Changelog
All notable changes to this project will be documented in this file.

The format is based on [Keep a Changelog](https://keepachangelog.com/en/1.0.0/),
and this project adheres to [Semantic Versioning](https://semver.org/spec/v2.0.0.html).

## Planned
- Remove alt_codes as these are best implemented as linked tables.
- Virtual tables allowing lookups with links to be queried and updated as a single table.

## [0.5.0]
### Added
- `lookuplabel` returns the list of codes and labels in the target lookup (after
  following links) when the code supplied is explicitly null. The labels in the 
  returned table applies all parameters supplied to the function. 
- `joinlabel` returns the list of codes and labels in the target table (after
  following links) when the source is supplied is explicitly null. The labels in
  the returned table applies all parameters supplied to the function.
- Alternate codes for matching is now a string parameter instead of column reference.
  This is more intuitive and can be more robust in the case of a wrong matching
  code being provided.

## [0.4.1] - 2022-07-06
### Added
- `lookuplabel` and `joinlabel` are no longer expanded in `Define` statements to 
  preserve the macro form in the resulting attributes of the defined table (or 
  struct). This defers the macro expansion to query execution time which provides 
  additional context information useful for the expansion. For instance, `lookuplabel`
  expands to a `select` expression which is valid when the query is executed on 
  the server but would not work directly in all cases if executed on the client-side;
  there a different method for obtaining the label (e.g. a hash table lookup) 
  might be more convenient or the only option.
- `lookuplabel` and `joinlabel` are similarly not expanded in uncomputed expressions
  for the same reasons. 

## [0.4.0] - 2022-06-21
### Added
- Column of `select` expression generated by `lookuplabel` is named `label` now.
  Previously it was using the default name (`column1` usually).
- Column of `select` expression generated by `joinlabel` is named `label` now.
  Previously it was using the default name (`column1` usually).

## [0.3.6] - 2022-05-25
### Changed
- Comply with ESQL version 0.9.7 (syntax change to `create table` where comma is 
  not allowed after table metadata, metadata at start of statement only, etc.).
- Additional information added as `description` to lookup values.
- `lookuplabel` macro changed to have an option controlling whether to include the
  description (default is false) in the label produced.
- `show_text` parameter has been renamed to `show_label` in `lookuplabel` macro.

## [0.3.5] - 2022-05-17
### Changed
- Comply with ESQL version 0.9.6.

## [0.3.4] - 2022-05-05
### Changed
- Comply with ESQL version 0.9.4.

## [0.3.3] - 2022-03-17
### Changed
- Comply with ESQL version 0.9.1.

## [0.3.2] - 2022-03-05
### Changed
- All class elements documented.
- Gradle build file normalised.
- Migrated to new ESQL version (0.8.9).

## [0.3.1] - 2022-02-25
### Tests
- All visual tests changed to assertions.

### Changed
- Include changes to the base Configuration object (method param changed to get).

### Fixed
- Test tables changed to remove non-literals from table metadata, as required by
  latest ESQL implementation.

## [0.3.0] - 2022-02-11
### Added
- The schema where the lookup tables are created can be configured on initialisation.
  Default is "_lookup".
- All lookup SQL Server functions are put in the (configured) lookup schema 
  instead of "_core".

### Changed
- Change name of extension class from `Lookups` to `LookupExtension`.

## [0.2.6] - 2022-02-09
### Changed
- Incorporate changes made to the 0.8.0+ line of ESQL. 

## [0.2.5] - 2022-01-14
### Changed
- Changed to work with ESQL version 0.7.0+. 

## [0.2.4] - 2021-12-25
### Changed
- Query generated by expansion of lookuplabel and joinlabel uses human-friendly
  names for the table aliases.

## [0.2.3] - 2021-12-19
### Refactored
- Refactored to include changes in the ESQL base library.

## [0.2.2] - 2021-04-13
### Added
- Join label tests passed.
- Extension documented.

## [0.2.1] - 2021-04-12
### Added
- LookupLabel, JoinLabel macros rewritten.
- LookupLabelFunction renamed to lookuplabelf.
- Column names in Lookup tables shortened.
- Lookup label tests passed.
- Option to match by code, alt_code1 and alt_code2 added to lookuplabel macro.
